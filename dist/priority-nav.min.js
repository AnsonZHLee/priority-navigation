/*! priority-nav - v0.1.0 | (c) 2015 @gijsroge | MIT license |  */
!function(a,b){"function"==typeof define&&define.amd?define("priorityNav",b(a)):"object"==typeof exports?module.exports=b(a):a.priorityNav=b(a)}(window||this,function(a){"use strict";function b(a,b,c){var d;return function(){var e=this,f=arguments,g=function(){d=null,c||a.apply(e,f)},h=c&&!d;clearTimeout(d),d=setTimeout(g,b),h&&a.apply(e,f)}}var c,d,e,f,g,h,i,j={},k=[],l=!!document.querySelector&&!!a.addEventListener,m={},n=0,o=0,p={initClass:"js-priorityNav",navWrapper:"nav",navMenu:".nav__menu",navDropdown:".nav__dropdown",navDropdownToggle:".nav__dropdown-toggle",navDropdownLabel:"more",throttleDelay:50,offsetPixels:25,childrenCount:!1,itemToDropdown:function(){},itemToNav:function(){}},q=function(a,b,c){if("[object Object]"===Object.prototype.toString.call(a))for(var d in a)Object.prototype.hasOwnProperty.call(a,d)&&b.call(c,a[d],d,a);else for(var e=0,f=a.length;f>e;e++)b.call(c,a[e],e,a)},r=function(a,b){for(var c=b.charAt(0);a&&a!==document;a=a.parentNode)if("."===c){if(a.classList.contains(b.substr(1)))return a}else if("#"===c){if(a.id===b.substr(1))return a}else if("["===c&&a.hasAttribute(b.substr(1,b.length-2)))return a;return!1},s=function(a,b){var c={};return q(a,function(b,d){c[d]=a[d]}),q(b,function(a,d){c[d]=b[d]}),c},t=function(a,b){if(a.classList)a.classList.toggle(b);else{var c=a.className.split(" "),d=c.indexOf(b);d>=0?c.splice(d,1):c.push(b),a.className=c.join(" ")}},u=function(a){if(!a.querySelector(m.navDropdown)&&!a.querySelector(m.navDropdownToggle)){var b=document.createElement("span"),c=document.createElement("ul"),d=document.createElement("button");d.innerHTML=m.navDropdownLabel,c.classList.add(m.navDropdown.substr(1)),d.classList.add(m.navDropdownToggle.substr(1)),a.insertAfter(b,a.querySelector(f)),b.style.position="relative",b.appendChild(c),b.appendChild(d)}},v=function(a){var b=window.getComputedStyle(a),c=parseFloat(b.paddingLeft)+parseFloat(b.paddingRight);return a.clientWidth-c},w=function(a){d=v(a),i=a.querySelector(g).parentNode===a?a.querySelector(g).offsetWidth:0,e=A(a)-i+m.offsetPixels},x=function(a,c){var h=0===a?h:m.throttleDelay;a++,b(function(){var a=c.getAttribute("instance");for(w(c);e>d&&c.querySelector(f).children.length>0;)j.toDropdown(c,a),w(c,a);for(;d>k[a][k[a].length-1];)j.toMenu(c,a);k[a].length<1&&c.querySelector(g).classList.remove("show"),y(c,a)},h)()},y=function(a,b){k[b].length<1?(a.querySelector(h).classList.add("is-hidden"),a.querySelector(h).classList.remove("is-visible"),a.classList.remove("has-dropdown")):(a.querySelector(h).classList.add("is-visible"),a.querySelector(h).classList.remove("is-hidden"),a.classList.add("has-dropdown"))},z=function(a,b){a.querySelector(h).dataset.count=k[b].length};j.toDropdown=function(a,b){a.querySelector(g).firstChild&&a.querySelector(f).children.length>0?a.querySelector(g).insertBefore(a.querySelector(f).lastElementChild,a.querySelector(g).firstChild):a.querySelector(f).children.length>0&&a.querySelector(g).appendChild(a.querySelector(f).lastElementChild),k[b].push(e),y(a,b),a.querySelector(f).children.length>0&&m.childrenCount&&z(a,b),m.itemToDropdown()},j.toMenu=function(a,b){a.querySelector(g).children.length>0&&a.querySelector(f).appendChild(a.querySelector(g).firstElementChild),k[b].pop(),y(a,b),a.querySelector(f).children.length>0&&m.childrenCount&&z(a,b),m.itemToNav()};var A=function(a){for(var b=a.childNodes,c=0,d=0;d<b.length;d++)3!==b[d].nodeType&&(isNaN(b[d].offsetWidth)||(c+=b[d].offsetWidth));return c},B=function(a){window.attachEvent?window.attachEvent("onresize",function(){x(n,a)}):window.addEventListener&&window.addEventListener("resize",function(){x(n,a)},!0),a.querySelector(h).addEventListener("click",function(){t(a.querySelector(m.navDropdown),"show"),t(this,"is-open"),t(a,"is-open")}),document.addEventListener("click",function(b){r(b.target,m.navDropdown)||b.target===a.querySelector(h)||(a.querySelector(g).classList.remove("show"),a.querySelector(h).classList.remove("is-open"),a.classList.remove("is-open"))}),document.onkeydown=function(a){a=a||window.event,27===a.keyCode&&(g.classList.remove("show"),h.classList.remove("is-open"),c.classList.remove("is-open"))}};return j.destroy=function(){m&&(document.documentElement.classList.remove(m.initClass),m=null,delete j.init)},Node.prototype.insertAfter=function(a,b){this.insertBefore(a,b.nextSibling)},j.init=function(a){if(!l)return void console.warn("This browser doesn't support priorityNav");m=s(p,a||{});var b=document.querySelectorAll(m.navWrapper);q(b,function(a){return k[o]=[],a.setAttribute("instance",o++),(c=a)?(f=m.navMenu,a.querySelector(f)?(u(a),g=m.navDropdown,a.querySelector(g)?(h=m.navDropdownToggle,a.querySelector(h)?(B(a),void x(n,a)):void console.warn("couldn't find the specified navDropdownToggle element")):void console.warn("couldn't find the specified navDropdown element")):void console.warn("couldn't find the specified navMenu element")):void console.warn("couldn't find the specified navWrapper element")}),n++,document.documentElement.classList.add(m.initClass)},j});
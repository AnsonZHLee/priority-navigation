/*
 * priority-nav - v0.1.0 | (c) 2015 @gijsroge | MIT license
 * Repository: https://github.com/gijsroge/priority-navigation.git
 * Description: Priority+ pattern navigation that hides menu items if they don't fit on screen.
 * Demo: http://gijsroge.github.io/priority-nav.js/
 */
!function(a,b){"function"==typeof define&&define.amd?define("priorityNav",b(a)):"object"==typeof exports?module.exports=b(a):a.priorityNav=b(a)}(window||this,function(a){"use strict";function b(a,b,c){var d;return function(){var e=this,f=arguments,g=function(){d=null,c||a.apply(e,f)},h=c&&!d;clearTimeout(d),d=setTimeout(g,b),h&&a.apply(e,f)}}var c,d,e,f,g,h,i,j,k={},l=[],m=!!document.querySelector&&!!a.addEventListener,n={},o=0,p=0,q={initClass:"js-priorityNav",mainNavWrapper:"nav",mainNav:"ul",navDropdown:".nav__dropdown",navDropdownToggle:".nav__dropdown-toggle",navDropdownLabel:"more",throttleDelay:50,offsetPixels:0,count:!0,moved:function(){},movedBack:function(){}},r=function(a,b,c){if("[object Object]"===Object.prototype.toString.call(a))for(var d in a)Object.prototype.hasOwnProperty.call(a,d)&&b.call(c,a[d],d,a);else for(var e=0,f=a.length;f>e;e++)b.call(c,a[e],e,a)},s=function(a,b){for(var c=b.charAt(0);a&&a!==document;a=a.parentNode)if("."===c){if(a.classList.contains(b.substr(1)))return a}else if("#"===c){if(a.id===b.substr(1))return a}else if("["===c&&a.hasAttribute(b.substr(1,b.length-2)))return a;return!1},t=function(a,b){var c={};return r(a,function(b,d){c[d]=a[d]}),r(b,function(a,d){c[d]=b[d]}),c},u=function(a,b){if(a.classList)a.classList.toggle(b);else{var c=a.className.split(" "),d=c.indexOf(b);d>=0?c.splice(d,1):c.push(b),a.className=c.join(" ")}},v=function(a){j=document.createElement("span"),g=document.createElement("ul"),h=document.createElement("button"),h.innerHTML=n.navDropdownLabel,a.insertAfter(j,a.querySelector(f)),j.appendChild(g),j.appendChild(h),g.classList.add(n.navDropdown.substr(1)),g.classList.add("priority-nav__dropdown"),h.classList.add(n.navDropdownToggle.substr(1)),h.classList.add("priority-nav__dropdown-toggle"),j.classList.add(n.navDropdown.substr(1)+"-wrapper"),j.classList.add("priority-nav__wrapper"),a.classList.add("priority-nav")},w=function(a){var b=window.getComputedStyle(a),c=parseFloat(b.paddingLeft)+parseFloat(b.paddingRight);return a.clientWidth-c},x=function(a){d=w(a),i=a.querySelector(g).parentNode===a?a.querySelector(g).offsetWidth:0,e=A(a)+n.offsetPixels};k.doesItFit=function(a){var c=0===a.getAttribute("instance")?c:n.throttleDelay;o++,b(function(){var b=a.getAttribute("instance");for(x(a);e>d&&a.querySelector(f).children.length>0;)k.toDropdown(a,b),x(a,b);for(;d>l[b][l[b].length-1];)k.toMenu(a,b);l[b].length<1&&a.querySelector(g).classList.remove("show"),y(a,b)},c)()};var y=function(a,b){l[b].length<1?(a.querySelector(h).classList.add("priority-nav-is-hidden"),a.querySelector(h).classList.remove("priority-nav-is-visible"),a.classList.remove("priority-nav-has-dropdown")):(a.querySelector(h).classList.add("priority-nav-is-visible"),a.querySelector(h).classList.remove("priority-nav-is-hidden"),a.classList.add("priority-nav-has-dropdown"))},z=function(a,b){a.querySelector(h).dataset.count=l[b].length};k.toDropdown=function(a,b){a.querySelector(g).firstChild&&a.querySelector(f).children.length>0?a.querySelector(g).insertBefore(a.querySelector(f).lastElementChild,a.querySelector(g).firstChild):a.querySelector(f).children.length>0&&a.querySelector(g).appendChild(a.querySelector(f).lastElementChild),l[b].push(e),y(a,b),a.querySelector(f).children.length>0&&n.count&&z(a,b),n.moved()},k.toMenu=function(a,b){a.querySelector(g).children.length>0&&a.querySelector(f).appendChild(a.querySelector(g).firstElementChild),l[b].pop(),y(a,b),a.querySelector(f).children.length>0&&n.count&&z(a,b),n.movedBack()};var A=function(a){for(var b=a.childNodes,c=0,d=0;d<b.length;d++)3!==b[d].nodeType&&(isNaN(b[d].offsetWidth)||(c+=b[d].offsetWidth));return c},B=function(a){window.attachEvent?window.attachEvent("onresize",function(){k.doesItFit&&k.doesItFit(o,a)}):window.addEventListener&&window.addEventListener("resize",function(){k.doesItFit&&k.doesItFit(o,a)},!0),a.querySelector(h).addEventListener("click",function(){u(a.querySelector(n.navDropdown),"show"),u(this,"is-open"),u(a,"is-open")}),document.addEventListener("click",function(b){s(b.target,n.navDropdown)||b.target===a.querySelector(h)||(a.querySelector(g).classList.remove("show"),a.querySelector(h).classList.remove("is-open"),a.classList.remove("is-open"))}),document.onkeydown=function(a){a=a||window.event,27===a.keyCode&&(g.classList.remove("show"),h.classList.remove("is-open"),c.classList.remove("is-open"))}};return Element.prototype.remove=function(){this.parentElement.removeChild(this)},NodeList.prototype.remove=HTMLCollection.prototype.remove=function(){for(var a=0,b=this.length;b>a;a++)this[a]&&this[a].parentElement&&this[a].parentElement.removeChild(this[a])},k.destroy=function(){n&&(document.documentElement.classList.remove(n.initClass),j.remove(),n=null,delete k.init,delete k.doesItFit)},Node.prototype.insertAfter=function(a,b){this.insertBefore(a,b.nextSibling)},k.init=function(a){if(!m)return void console.warn("This browser doesn't support priorityNav");n=t(q,a||{});var b=document.querySelectorAll(n.mainNavWrapper);r(b,function(a){return l[p]=[],a.setAttribute("instance",p++),(c=a)?(f=n.mainNav,a.querySelector(f)?(v(a),g=n.navDropdown,a.querySelector(g)?(h=n.navDropdownToggle,a.querySelector(h)?(B(a),void k.doesItFit(a)):void console.warn("couldn't find the specified navDropdownToggle element")):void console.warn("couldn't find the specified navDropdown element")):void console.warn("couldn't find the specified mainNav element")):void console.warn("couldn't find the specified mainNavWrapper element")}),o++,document.documentElement.classList.add(n.initClass)},k});